<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>fl.Boolean_Grammars.ThreeValuedLangDef</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library fl.Boolean_Grammars.ThreeValuedLangDef</h1>

<div class="code">
<span class="comment">(*&nbsp;Require&nbsp;Import&nbsp;List.&nbsp;<br/>
Import&nbsp;ListNotations.&nbsp;<br/>
Require&nbsp;Import&nbsp;Fin.<br/>
From&nbsp;mathcomp&nbsp;Require&nbsp;Import&nbsp;ssreflect&nbsp;ssrbool&nbsp;eqtype&nbsp;ssrnat&nbsp;seq&nbsp;fintype&nbsp;bigop&nbsp;path&nbsp;ssrfun.<br/>
<br/>
<br/>
Inductive&nbsp;ter&nbsp;:&nbsp;Type&nbsp;:=<br/>
|&nbsp;T&nbsp;:&nbsp;nat&nbsp;-&gt;&nbsp;ter.<br/>
<br/>
Inductive&nbsp;var&nbsp;:&nbsp;Type&nbsp;:=<br/>
|&nbsp;V&nbsp;:&nbsp;nat&nbsp;-&gt;&nbsp;var.<br/>
<br/>
Inductive&nbsp;symbol&nbsp;:&nbsp;Type&nbsp;:=<br/>
|&nbsp;Ts&nbsp;:&nbsp;ter&nbsp;-&gt;&nbsp;symbol<br/>
|&nbsp;Vs&nbsp;:&nbsp;var&nbsp;-&gt;&nbsp;symbol.<br/>
<br/>
Inductive&nbsp;rhs&nbsp;:&nbsp;Type&nbsp;:=<br/>
|&nbsp;Con&nbsp;:&nbsp;seq&nbsp;rhs&nbsp;-&gt;&nbsp;rhs<br/>
|&nbsp;And&nbsp;:&nbsp;seq&nbsp;rhs&nbsp;-&gt;&nbsp;rhs<br/>
|&nbsp;Neg&nbsp;:&nbsp;rhs&nbsp;-&gt;&nbsp;rhs<br/>
|&nbsp;Sym&nbsp;:&nbsp;symbol&nbsp;-&gt;&nbsp;rhs.<br/>
<br/>
Definition&nbsp;rule&nbsp;:&nbsp;Type&nbsp;:=&nbsp;(var&nbsp;*&nbsp;rhs).<br/>
<br/>
Definition&nbsp;Grammar&nbsp;:&nbsp;Type&nbsp;:=&nbsp;seq&nbsp;ter&nbsp;*&nbsp;seq&nbsp;var&nbsp;*&nbsp;seq&nbsp;rule&nbsp;*&nbsp;var.<br/>
<br/>
Section&nbsp;Section1.<br/>
<br/>
&nbsp;&nbsp;Section&nbsp;Section11.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;A&nbsp;:=&nbsp;nat.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Definition&nbsp;f1&nbsp;(lst:&nbsp;seq&nbsp;A)&nbsp;:=&nbsp;[seq&nbsp;(take&nbsp;x&nbsp;lst,&nbsp;drop&nbsp;x&nbsp;lst)&nbsp;|&nbsp;x&nbsp;&lt;-&nbsp;iota&nbsp;0&nbsp;(length&nbsp;lst)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Fixpoint&nbsp;f2&nbsp;lst&nbsp;n&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;n&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;=&gt;&nbsp;nil<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1&nbsp;=&gt;&nbsp;lst<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;S&nbsp;n&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;n2&nbsp;:=&nbsp;map&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;(fst&nbsp;x,&nbsp;f1&nbsp;(snd&nbsp;x)))&nbsp;lst&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;n3&nbsp;:=&nbsp;flatten&nbsp;&nbsp;(map&nbsp;&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;map&nbsp;(fun&nbsp;y&nbsp;=&gt;&nbsp;(fst&nbsp;x&nbsp;++&nbsp;[fst&nbsp;y],&nbsp;snd&nbsp;y))&nbsp;(snd&nbsp;x))&nbsp;&nbsp;n2)&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f2&nbsp;n3&nbsp;n<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Definition&nbsp;f&nbsp;lst&nbsp;n&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;n1&nbsp;:=&nbsp;map&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;([fst&nbsp;x],snd&nbsp;x))&nbsp;(f1&nbsp;lst)&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;res&nbsp;:=&nbsp;f2&nbsp;n1&nbsp;n&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;fst&nbsp;(filter&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;snd&nbsp;x&nbsp;==&nbsp;[])&nbsp;res).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;End&nbsp;Section11.<br/>
<br/>
&nbsp;&nbsp;Section&nbsp;Section12.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Definition&nbsp;minimum&nbsp;xs&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;xs&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;nil&nbsp;=&gt;&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;y::ys&nbsp;=&gt;&nbsp;foldl&nbsp;minn&nbsp;y&nbsp;ys<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Definition&nbsp;maximum&nbsp;xs&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;xs&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;nil&nbsp;=&gt;&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;y::ys&nbsp;=&gt;&nbsp;foldl&nbsp;maxn&nbsp;y&nbsp;ys<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Definition&nbsp;concat&nbsp;(langs:&nbsp;seq&nbsp;(seq&nbsp;nat&nbsp;-&gt;&nbsp;nat))&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;string&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(map&nbsp;minimum&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(map&nbsp;(map&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;(fst&nbsp;x)&nbsp;(snd&nbsp;x)))&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(map&nbsp;(zip&nbsp;langs)&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;string&nbsp;(length&nbsp;langs))))).<br/>
<br/>
&nbsp;&nbsp;End&nbsp;Section12.<br/>
&nbsp;&nbsp;<br/>
End&nbsp;Section1.<br/>
<br/>
Section&nbsp;Section2.<br/>
<br/>
&nbsp;&nbsp;Let&nbsp;A&nbsp;:=&nbsp;nat.<br/>
<br/>
&nbsp;&nbsp;Definition&nbsp;Interpretation&nbsp;:&nbsp;Type&nbsp;:=&nbsp;var&nbsp;-&gt;&nbsp;seq&nbsp;A&nbsp;-&gt;&nbsp;nat.<br/>
&nbsp;&nbsp;Definition&nbsp;ExtendedInterpretation&nbsp;:&nbsp;Type&nbsp;:=&nbsp;rhs&nbsp;-&gt;&nbsp;seq&nbsp;A&nbsp;-&gt;&nbsp;nat.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Definition&nbsp;extendedInterpretation&nbsp;(interpretation:&nbsp;Interpretation):&nbsp;ExtendedInterpretation&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fix&nbsp;intExtHelp&nbsp;(r:&nbsp;rhs)&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;r&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;And&nbsp;nil&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;if&nbsp;string&nbsp;==&nbsp;nil&nbsp;then&nbsp;2&nbsp;else&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Con&nbsp;nil&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;if&nbsp;string&nbsp;==&nbsp;nil&nbsp;then&nbsp;2&nbsp;else&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Sym&nbsp;(Ts&nbsp;(T&nbsp;a))&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;if&nbsp;string&nbsp;==&nbsp;[::a]&nbsp;then&nbsp;2&nbsp;else&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Sym&nbsp;(Vs&nbsp;a)&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;interpretation&nbsp;a&nbsp;string<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Con&nbsp;rs&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;concat&nbsp;(map&nbsp;intExtHelp&nbsp;rs)&nbsp;string<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Neg&nbsp;r&nbsp;=&gt;&nbsp;fun&nbsp;string&nbsp;=&gt;&nbsp;2&nbsp;-&nbsp;intExtHelp&nbsp;r&nbsp;string<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;And&nbsp;rs&nbsp;=&gt;&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;A)&nbsp;=&gt;&nbsp;minimum&nbsp;(map&nbsp;(fun&nbsp;r&nbsp;=&gt;&nbsp;intExtHelp&nbsp;r&nbsp;string)&nbsp;rs)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;rhs&nbsp;string&nbsp;=&gt;&nbsp;intExtHelp&nbsp;rhs&nbsp;string.<br/>
<br/>
End&nbsp;Section2.<br/>
<br/>
Section&nbsp;Section3.<br/>
<br/>
&nbsp;&nbsp;Definition&nbsp;isNegative&nbsp;rhs&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;rhs&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Neg&nbsp;_&nbsp;=&gt;&nbsp;true<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;false<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;Definition&nbsp;isPositive&nbsp;rhs&nbsp;:=&nbsp;~~&nbsp;(isNegative&nbsp;rhs).<br/>
&nbsp;&nbsp;<br/>
End&nbsp;Section3.<br/>
<br/>
Section&nbsp;Section4.<br/>
<br/>
&nbsp;&nbsp;Definition&nbsp;eq_r&nbsp;nt&nbsp;(rule:&nbsp;rule)&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(lhs,_)&nbsp;:=&nbsp;rule&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;nt,&nbsp;lhs&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;V&nbsp;n,&nbsp;V&nbsp;lh&nbsp;=&gt;&nbsp;n&nbsp;==&nbsp;lh<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Definition&nbsp;theta&nbsp;(grammar:&nbsp;Grammar)&nbsp;(intJ:&nbsp;Interpretation)&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;intI&nbsp;nt&nbsp;string&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;'(ts,&nbsp;nts,&nbsp;rules,&nbsp;ss)&nbsp;:=&nbsp;grammar&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;extIntI&nbsp;:=&nbsp;extendedInterpretation&nbsp;intI&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;extIntJ&nbsp;:=&nbsp;extendedInterpretation&nbsp;intJ&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rhss&nbsp;:=&nbsp;map&nbsp;snd&nbsp;(filter&nbsp;(fun&nbsp;rule&nbsp;=&gt;&nbsp;eq_r&nbsp;nt&nbsp;rule)&nbsp;rules)&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;res1&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;rhs&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;rhs&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;And&nbsp;rhs1&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;posAts&nbsp;:=&nbsp;filter&nbsp;isPositive&nbsp;rhs1&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;negAts&nbsp;:=&nbsp;filter&nbsp;isNegative&nbsp;rhs1&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;(fun&nbsp;li&nbsp;=&gt;&nbsp;extIntI&nbsp;li&nbsp;string&nbsp;==&nbsp;2)&nbsp;posAts&nbsp;&amp;&amp;&nbsp;all&nbsp;(fun&nbsp;li&nbsp;=&gt;&nbsp;extIntJ&nbsp;li&nbsp;string&nbsp;==&nbsp;2)&nbsp;negAts<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Neg&nbsp;rhs&nbsp;=&gt;&nbsp;extIntJ&nbsp;(Neg&nbsp;rhs)&nbsp;string&nbsp;==&nbsp;2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;rhs&nbsp;=&gt;&nbsp;extIntI&nbsp;rhs&nbsp;string&nbsp;==&nbsp;2&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;rhss&nbsp;in&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;res2&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;rhs&nbsp;=&gt;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;rhs&nbsp;with&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;And&nbsp;rhs1=&gt;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;posAts&nbsp;:=&nbsp;filter&nbsp;isPositive&nbsp;rhs1&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;negAts&nbsp;:=&nbsp;filter&nbsp;isNegative&nbsp;rhs1&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has&nbsp;(fun&nbsp;li&nbsp;=&gt;&nbsp;extIntI&nbsp;li&nbsp;string&nbsp;==&nbsp;0)&nbsp;posAts&nbsp;||&nbsp;has&nbsp;(fun&nbsp;li&nbsp;=&gt;&nbsp;extIntJ&nbsp;li&nbsp;string&nbsp;==&nbsp;0)&nbsp;negAts<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Neg&nbsp;rhs&nbsp;=&gt;&nbsp;extIntJ&nbsp;(Neg&nbsp;rhs)&nbsp;string&nbsp;==&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;rhs&nbsp;=&gt;&nbsp;extIntI&nbsp;rhs&nbsp;string&nbsp;==&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;rhss&nbsp;in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;res1&nbsp;then&nbsp;2&nbsp;else&nbsp;if&nbsp;res2&nbsp;then&nbsp;0&nbsp;else&nbsp;1.<br/>
<br/>
&nbsp;&nbsp;Definition&nbsp;botIntT&nbsp;(nt:&nbsp;var)&nbsp;:=&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;nat)&nbsp;=&gt;&nbsp;0.<br/>
&nbsp;&nbsp;Definition&nbsp;botIntI&nbsp;(nt:&nbsp;var)&nbsp;:=&nbsp;fun&nbsp;(string:&nbsp;seq&nbsp;nat)&nbsp;=&gt;&nbsp;1.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Fixpoint&nbsp;omeg&nbsp;(grammar:&nbsp;Grammar)&nbsp;(interp:&nbsp;Interpretation)&nbsp;(n:&nbsp;nat):&nbsp;Interpretation&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;n&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;=&gt;&nbsp;botIntT<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;S&nbsp;n&nbsp;=&gt;&nbsp;theta&nbsp;grammar&nbsp;interp&nbsp;(omeg&nbsp;grammar&nbsp;interp&nbsp;n)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;Fixpoint&nbsp;m&nbsp;(grammar:&nbsp;Grammar)&nbsp;(n&nbsp;k:&nbsp;nat):&nbsp;Interpretation&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;n&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;=&gt;&nbsp;botIntI<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;S&nbsp;n&nbsp;=&gt;&nbsp;omeg&nbsp;grammar&nbsp;(m&nbsp;grammar&nbsp;n&nbsp;k)&nbsp;k<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
<br/>
End&nbsp;Section4.<br/>
<br/>
Section&nbsp;WW.<br/>
<br/>
&nbsp;&nbsp;Definition&nbsp;ww:&nbsp;Grammar:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(nil,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neg&nbsp;(Con&nbsp;[Sym&nbsp;(Vs&nbsp;(V&nbsp;1));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;2))]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neg&nbsp;(Con&nbsp;[Sym&nbsp;(Vs&nbsp;(V&nbsp;2));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;1))]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neg&nbsp;(Sym&nbsp;(Vs&nbsp;(V&nbsp;1)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neg&nbsp;(Sym&nbsp;(Vs&nbsp;(V&nbsp;2)))]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;1,&nbsp;And&nbsp;[Sym&nbsp;(Ts&nbsp;(T&nbsp;0))]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;1,&nbsp;And&nbsp;[Con&nbsp;[Sym&nbsp;(Vs&nbsp;(V&nbsp;3));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;1));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;3))]]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;2,&nbsp;And&nbsp;[Sym&nbsp;(Ts&nbsp;(T&nbsp;1))]);&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;2,&nbsp;And&nbsp;[Con&nbsp;[Sym&nbsp;(Vs&nbsp;(V&nbsp;3));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;2));&nbsp;Sym&nbsp;(Vs&nbsp;(V&nbsp;3))]]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;3,&nbsp;And&nbsp;[Sym&nbsp;(Ts&nbsp;(T&nbsp;0))]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(V&nbsp;3,&nbsp;And&nbsp;[Sym&nbsp;(Ts&nbsp;(T&nbsp;1))])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;0).&nbsp;<br/>
<br/>
&nbsp;&nbsp;Example&nbsp;example1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(m&nbsp;ww&nbsp;2&nbsp;2)&nbsp;(V&nbsp;0)&nbsp;[0;0;1;&nbsp;0;0;1]&nbsp;==&nbsp;2.<br/>
&nbsp;&nbsp;Proof.&nbsp;by&nbsp;done.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;lemma1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;lst,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst&nbsp;=&nbsp;[::0]&nbsp;\/&nbsp;lst&nbsp;=&nbsp;[::1]&nbsp;&lt;-&gt;&nbsp;(m&nbsp;ww&nbsp;1&nbsp;1)&nbsp;(V&nbsp;3)&nbsp;lst&nbsp;==&nbsp;2.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;lst&nbsp;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;split;&nbsp;[move&nbsp;=&gt;&nbsp;[H|H]|&nbsp;move&nbsp;=&gt;&nbsp;H].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;subst&nbsp;lst.&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;subst&nbsp;lst.&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;destruct&nbsp;lst;&nbsp;first&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;lst;&nbsp;first&nbsp;destruct&nbsp;n.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left.&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right.&nbsp;destruct&nbsp;n.&nbsp;by&nbsp;done.&nbsp;simpl&nbsp;in&nbsp;H.&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simpl&nbsp;in&nbsp;H.&nbsp;admit.<br/>
&nbsp;&nbsp;Admitted.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;lemma2:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;lst&nbsp;lst1&nbsp;lst2,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(m&nbsp;ww&nbsp;1&nbsp;1)&nbsp;(V&nbsp;2)&nbsp;lst&nbsp;==&nbsp;2&nbsp;&lt;-&gt;&nbsp;lst&nbsp;=&nbsp;lst1&nbsp;++&nbsp;[::1]&nbsp;++&nbsp;lst2.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;Admitted.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;lemma3:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;lst&nbsp;lst1&nbsp;lst2,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(m&nbsp;ww&nbsp;1&nbsp;1)&nbsp;(V&nbsp;1)&nbsp;lst&nbsp;==&nbsp;2&nbsp;&lt;-&gt;&nbsp;lst&nbsp;=&nbsp;lst1&nbsp;++&nbsp;[::0]&nbsp;++&nbsp;lst2.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;Admitted.&nbsp;<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;lemma4:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;lst&nbsp;lst',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(m&nbsp;ww&nbsp;2&nbsp;2)&nbsp;(V&nbsp;0)&nbsp;lst&nbsp;==&nbsp;2&nbsp;&lt;-&gt;&nbsp;lst&nbsp;=&nbsp;lst'&nbsp;++&nbsp;lst'.&nbsp;<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;split;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;admit.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;subst&nbsp;lst.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;simpl.<br/>
&nbsp;&nbsp;&nbsp;Admitted.&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Example&nbsp;example2:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;lst,&nbsp;exists&nbsp;k,&nbsp;(m&nbsp;ww&nbsp;k&nbsp;k)&nbsp;(V&nbsp;0)&nbsp;(lst&nbsp;++&nbsp;lst)&nbsp;==&nbsp;2.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;lst.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;exists&nbsp;2.&nbsp;by&nbsp;done.<br/>
&nbsp;&nbsp;Admitted.<br/>
&nbsp;&nbsp;<br/>
End&nbsp;SectionName5.&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>